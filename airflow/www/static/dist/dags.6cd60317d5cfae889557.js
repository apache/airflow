/*!
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */

/*! For license information please see dags.6cd60317d5cfae889557.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Airflow=e():(t.Airflow=t.Airflow||{},t.Airflow.dags=e())}(self,(()=>(()=>{"use strict";var t={4965:(t,e,a)=>{a.d(e,{dagTZ:()=>s});var n=a(8956),o=a(1068);$(window).on("load",(function(){$(`a[href*="${this.location.pathname}"]`).parent().addClass("active"),$(".never_active").removeClass("active")}));const r=(0,n.au)("dag_id"),s=(0,n.au)("dag_timezone"),i=(0,n.au)("logs_with_metadata_url"),d=(0,n.au)("external_log_url"),l=(0,n.au)("extra_links_url"),c=(0,n.au)("paused_url"),u={createAfter:(0,n.au)("next_dagrun_create_after"),intervalStart:(0,n.au)("next_dagrun_data_interval_start"),intervalEnd:(0,n.au)("next_dagrun_data_interval_end")};let m,p="",_="",f="",g="",h=[];const v="True"===(0,n.au)("show_external_log_redirect"),b=Array.from(document.querySelectorAll('a[id^="btn_"][data-base-url]')).reduce(((t,e)=>(t[e.id.replace("btn_","")]=e,t)),{});function w(t,e){let a=t.dataset.baseUrl;e.dag_id&&-1!==t.dataset.baseUrl.indexOf(r)&&(a=a.replace(r,e.dag_id),delete e.dag_id),Object.prototype.hasOwnProperty.call(e,"map_index")&&void 0===e.map_index&&delete e.map_index,t.setAttribute("href",`${a}?${$.param(e)}`)}function x(){w(b.subdag,{dag_id:f,execution_date:_}),w(b.task,{dag_id:r,task_id:p,execution_date:_,map_index:m}),w(b.rendered,{dag_id:r,task_id:p,execution_date:_,map_index:m}),w(b.mapped,{_flt_3_dag_id:r,_flt_3_task_id:p,_flt_3_run_id:g,_oc_TaskInstanceModelView:"map_index"}),b.rendered_k8s&&w(b.rendered_k8s,{dag_id:r,task_id:p,execution_date:_,map_index:m});const t={_flt_3_dag_id:r,_flt_3_task_id:p,_oc_TaskInstanceModelView:"dag_run.execution_date"};m>=0&&(t._flt_0_map_index=m),w(b.ti,t),w(b.log,{dag_id:r,task_id:p,execution_date:_,map_index:m}),w(b.xcom,{dag_id:r,task_id:p,execution_date:_,map_index:m})}function k({taskId:t,executionDate:e,extraLinks:a,tryNumber:n,isSubDag:s,dagRunId:c,mapIndex:u,isMapped:b=!1,mappedStates:w=[]}){p=t;const k=String(window.location);if($("#btn_filter").on("click",(()=>{window.location=function(t,e,a){const n=new RegExp(`([?&])${e}=.*?(&|$)`,"i"),o=-1!==t.indexOf("?")?"&":"?";return t.match(n)?t.replace(n,`$1${e}=${a}$2`):`${t}${o}${e}=${a}`}(k,"root",p)})),_=e,g=c,m=u,b&&(h=w),$("#dag_run_id").text(c),$("#task_id").text(t),$("#execution_date").text((0,o.o0)(e)),$("#taskInstanceModal").modal({}),$("#taskInstanceModal").css("margin-top","0"),$("#extra_links").prev("hr").hide(),$("#extra_links").empty().hide(),u>=0?($("#modal_map_index").show(),$("#modal_map_index .value").text(u)):($("#modal_map_index").hide(),$("#modal_map_index .value").text("")),s?($("#div_btn_subdag").show(),f=`${r}.${t}`):($("#div_btn_subdag").hide(),f=void 0),u>=0&&!h.length)$("#modal_map_index").show(),$("#modal_map_index .value").text(u),$("#mapped_dropdown").hide();else if(u>=0||b){$("#modal_map_index").show(),$("#modal_map_index .value").text(""),$("#mapped_dropdown").show();const t=m>-1?m:`All  ${h.length} Mapped Instances`;$("#mapped_dropdown #dropdown-label").text(t),$("#mapped_dropdown .dropdown-menu").empty(),$("#mapped_dropdown .dropdown-menu").append(`<li><a href="#" class="map_index_item" data-mapIndex="all">All ${h.length} Mapped Instances</a></li>`),h.forEach(((t,e)=>{$("#mapped_dropdown .dropdown-menu").append(`<li><a href="#" class="map_index_item" data-mapIndex="${e}">${e} - ${t}</a></li>`)}))}else $("#modal_map_index").hide(),$("#modal_map_index .value").text(""),$("#mapped_dropdown").hide();b?($("#task_actions").text(`Task Actions for all ${w.length} instances`),$("#btn_mapped").show(),$("#mapped_dropdown").css("display","inline-block"),$("#btn_rendered").hide(),$("#btn_xcom").hide(),$("#btn_log").hide(),$("#btn_task").hide()):($("#task_actions").text("Task Actions"),$("#btn_rendered").show(),$("#btn_xcom").show(),$("#btn_log").show(),$("#btn_mapped").hide(),$("#btn_task").show()),$("#dag_dl_logs").hide(),$("#dag_redir_logs").hide(),n>0&&!b&&($("#dag_dl_logs").show(),v&&$("#dag_redir_logs").show()),x(),$("#try_index > li").remove(),$("#redir_log_try_index > li").remove();const y=n>2?0:1,T=new URLSearchParams({dag_id:r,task_id:p,execution_date:_,metadata:"null"});void 0!==u&&T.set("map_index",u);for(let t=y;t<n;t+=1){let e=t;0!==t?T.set("try_number",t):e="All",$("#try_index").append(`<li role="presentation" style="display:inline">\n      <a href="${i}?${T}&format=file"> ${e} </a>\n      </li>`),(0!==t||v)&&$("#redir_log_try_index").append(`<li role="presentation" style="display:inline">\n      <a href="${d}?${T}"> ${e} </a>\n      </li>`)}if(T.delete("try_number"),a&&a.length>0){const t=[];a.sort(),$.each(a,((e,a)=>{T.set("link_name",a);const n=$('<a href="#" class="btn btn-primary disabled"></a>'),o=$('<span class="tool-tip" data-toggle="tooltip" style="padding-right: 2px; padding-left: 3px" data-placement="top" title="link not yet available"></span>');o.append(n),n.text(a),$.ajax({url:`${l}?${T}`,cache:!1,success(t){n.attr("href",t.url),/^(?:[a-z]+:)?\/\//.test(t.url)&&n.attr("target","_blank"),n.removeClass("disabled"),o.tooltip("disable")},error(t){o.tooltip("hide").attr("title",t.responseJSON.error).tooltip("fixTitle")}}),t.push(o)}));const e=$("#extra_links");e.prev("hr").show(),e.append(t).show(),e.find('[data-toggle="tooltip"]').tooltip()}}document.addEventListener("click",(t=>{t.target.matches('button[data-toggle="button"]')&&x()})),$(document).on("click",".map_index_item",(function(){const t=$(this).attr("data-mapIndex");k("all"===t?{taskId:p,executionDate:_,dagRunId:g,mapIndex:-1,isMapped:!0,mappedStates:h}:{taskId:p,executionDate:_,dagRunId:g,mapIndex:t})})),$("form[data-action]").on("submit",(function(t){t.preventDefault();const e=$(this).get(0);(g||_)&&(e.dag_run_id&&(e.dag_run_id.value=g),e.execution_date&&(e.execution_date.value=_),e.origin.value=window.location,e.task_id&&(e.task_id.value=p),e.map_index&&m>=0?e.map_index.value=m:e.map_index&&e.map_index.remove(),e.action=$(this).data("action"),e.submit())})),$("#pause_resume").on("change",(function(){const t=$(this),e=t.data("dag-id"),a=t.is(":checked"),n=`${c}?is_paused=${a}&dag_id=${encodeURIComponent(e)}`;t.trigger("blur"),t.removeClass("switch-input--error");const o=new CustomEvent("paused",{detail:a});document.dispatchEvent(o),$.post(n).fail((()=>{setTimeout((()=>{t.prop("checked",!a),t.addClass("switch-input--error"),o.value=!a,document.dispatchEvent(o)}),500)}))})),$("#next-run").on("mouseover",(()=>{$("#next-run").attr("data-original-title",(()=>{let t="";return u.createAfter&&(t+=`<strong>Run After:</strong> ${(0,o.o0)(u.createAfter)}<br>`,t+=`Next Run: ${(0,o.K5)(u.createAfter)}<br><br>`),u.intervalStart&&u.intervalEnd&&(t+="<strong>Data Interval</strong><br>",t+=`Start: ${(0,o.o0)(u.intervalStart)}<br>`,t+=`End: ${(0,o.o0)(u.intervalEnd)}`),t}))}))},1068:(t,e,a)=>{a.d(e,{$O:()=>i,K5:()=>m,M1:()=>d,n0:()=>l,o0:()=>c,oY:()=>u,sK:()=>n,z6:()=>s});const n="YYYY-MM-DD, HH:mm:ss",o="YYYY-MM-DD, HH:mm:ss z",r="z (Z)",s="YYYY-MM-DDThh:mm:ssTZD",i="timezone";function d(t){return t instanceof moment?t.isUTC()?"UTC":t.format(r):"UTC"===t?t:moment().tz(t).format(r)}function l(t,e){const a=moment(t),o=$.extend({title:!0},e).title,r=document.createElement("time");return r.setAttribute("datetime",a.format()),o&&r.setAttribute("title",a.isUTC()?"":`UTC: ${a.clone().utc().format()}`),r.innerText=a.format(n),r}const c=t=>moment(t).format(o);function u(t){moment.tz.setDefault(t),$('time[data-datetime-convert!="false"]').each(((t,e)=>{const a=$(e),r=moment(a.attr("datetime"));r._isValid&&a.text(r.format(a.data("with-tz")?o:n)),void 0!==a.attr("title")&&a.attr("title",r.isUTC()?"":`UTC: ${r.clone().utc().format()}`)})),$(".datetime input").each(((t,e)=>{e.value=moment(e.value).format()}))}const m=t=>`${moment(t).fromNow()}`},5122:(t,e,a)=>{a.d(e,{escapeHtml:()=>i});var n=a(1068);function o(){const t=moment();$("#clock").attr("datetime",t.format(n.z6)).html(`${t.format("HH:mm")} <strong>${(0,n.M1)(t)}</strong>`)}function r(t){localStorage.setItem("selected-timezone",t);const e=new CustomEvent(n.$O,{detail:t});document.dispatchEvent(e),(0,n.oY)(t),o(),$("body").trigger({type:"airflow.timezone-change",timezone:t})}window.isoDateToTimeEl=n.n0,window.moment=Airflow.moment;const s=document.createElement("span");function i(t){return s.textContent=t,s.innerHTML}window.escapeHtml=i,window.convertSecsToHumanReadable=function(t){const e=t,a=e-Math.floor(e);t=Math.floor(t);const n=Math.floor(t/3600);t-=3600*n;const o=Math.floor(t/60);let r="";return n>0&&(r+=`${n}Hours `),o>0&&(r+=`${o}Min `),(t-=60*o)+a>0&&(Math.floor(e)===e?r+=`${t}Sec`:r+=`${(t+=a).toFixed(3)}Sec`),r},window.postAsForm=function(t,e){const a=$("<form></form>");a.attr("method","POST"),a.attr("action",t),$.each(e||{},((t,e)=>{const n=$("<input></input>");n.attr("type","hidden"),n.attr("name",t),n.attr("value",e),a.append(n)}));const n=$("<input></input>");n.attr("type","hidden"),n.attr("name","csrf_token"),n.attr("value",csrfToken),a.append(n),$(document.body).append(a),a.submit()},$(document).ready((()=>{!function(){const t=moment.tz.guess(),e=localStorage.getItem("selected-timezone"),a=localStorage.getItem("chosen-timezone");function o(e){localStorage.setItem("chosen-timezone",e),e!==t||e!==Airflow.serverTimezone?($("#timezone-manual a").data("timezone",e).text((0,n.M1)(e)),$("#timezone-manual").show()):$("#timezone-manual").hide()}a&&o(a),r(e||Airflow.defaultUITimezone),"UTC"!==Airflow.serverTimezone&&($("#timezone-server a").html(`${(0,n.M1)(Airflow.serverTimezone)} <span class="label label-primary">Server</span>`),$("#timezone-server").show()),Airflow.serverTimezone!==t?$("#timezone-local a").attr("data-timezone",t).html(`${(0,n.M1)(t)} <span class="label label-info">Local</span>`):$("#timezone-local").hide(),$("a[data-timezone]").click((t=>{r($(t.currentTarget).data("timezone"))})),$("#timezone-other").typeahead({source:$(moment.tz.names().map((t=>({category:t.split("/",1)[0],name:t.replace("_"," "),tzName:t})))),showHintOnFocus:"all",showCategoryHeader:!0,items:"all",afterSelect(t){this.$element.val(""),o(t.tzName),r(t.tzName),setTimeout((()=>{document.activeElement.blur(),this.shown=!1,this.focused=!1}),1)}})}(),$("#clock").attr("data-original-title",hostName).attr("data-placement","bottom").parent().show(),o(),setInterval(o,1e3),$.ajaxSetup({beforeSend(t,e){/^(GET|HEAD|OPTIONS|TRACE)$/i.test(e.type)||this.crossDomain||t.setRequestHeader("X-CSRFToken",csrfToken)}}),$.fn.datetimepicker.defaults.format="YYYY-MM-DD HH:mm:ssZ",$.fn.datetimepicker.defaults.sideBySide=!0,$(".datetimepicker").datetimepicker(),$("#filter_form a.filter").click((()=>{$(".datetimepicker").datetimepicker()})),$(".js-tooltip").tooltip()}))},3897:(t,e,a)=>{a.d(e,{default:()=>d});var n=a(5122),o=a(1068),r=a(4965),s=a(8956);function i(t,e){const a=e&&e instanceof moment&&e.isValid();return`Started: ${t.format(o.sK)}<br>Ended: ${a?e.format(o.sK):"Not ended yet"}<br>`}function d(t,{includeTryNumber:e=!1}={}){let a="";if(void 0!==t.state&&(a+=`<strong>Status:</strong> ${(0,n.escapeHtml)(t.state)}<br><br>`),t.mapped_states){const e=(0,s.Z2)();t.mapped_states.forEach((t=>{const a=t||"no_status";e.has(a)&&e.set(a,e.get(a)+1)})),a+=`<strong>${(0,n.escapeHtml)(t.mapped_states.length)} ${1===t.mapped_states.length?"Task":"Tasks"} Mapped</strong><br />`,e.forEach(((t,e)=>{t>0&&(a+=`<span style="margin-left: 15px">${(0,n.escapeHtml)(e)}: ${(0,n.escapeHtml)(t)}</span><br />`)})),a+="<br />"}if(void 0!==t.task_id&&(a+=`Task_id: ${(0,n.escapeHtml)(t.task_id)}<br>`),a+=`Run: ${(0,o.o0)(t.execution_date)}<br>`,void 0!==t.run_id&&(a+=`Run Id: <nobr>${(0,n.escapeHtml)(t.run_id)}</nobr><br>`),t.map_index>=0&&!t.mapped_states&&(a+=`Map Index: ${(0,n.escapeHtml)(t.map_index)}<br>`),void 0!==t.operator&&(a+=`Operator: ${(0,n.escapeHtml)(t.operator)}<br>`),"running"===t.state){const e=t.start_date instanceof moment?t.start_date:moment(t.start_date);t.duration=moment().diff(e,"second")}else if(!t.duration&&t.end_date){const e=t.start_date instanceof moment?t.start_date:moment(t.start_date),a=t.end_date instanceof moment?t.end_date:moment(t.end_date);t.duration=moment(a).diff(e,"second")}a+=`Duration: ${(0,n.escapeHtml)(convertSecsToHumanReadable(t.duration))}<br>`;const d=t.data_interval_start,l=t.data_interval_end;return d&&l&&(a+="<br><strong>Data Interval:</strong><br>",a+=`Start: ${(0,o.o0)(d)}<br>`,a+=`End: ${(0,o.o0)(l)}<br>`),e&&(a+=`Try Number: ${(0,n.escapeHtml)(t.try_number)}<br>`),a+=function(t,e,a){if(!t)return"<br><em>Not yet started</em>";const n="z (Z)",o=moment.defaultZone.name.toUpperCase(),r=moment.utc(t),s=moment.utc(e),d=a.toUpperCase();let l="<br><strong>UTC:</strong><br>";l+=i(r,s),"UTC"!==o&&(r.tz(o),l+=`<br><strong>Local: ${r.format(n)}</strong><br>`,l+=i(r,s&&s instanceof moment?s.tz(o):s));"UTC"!==d&&d!==o&&(r.tz(d),l+=`<br><strong>DAG's TZ: ${r.format(n)}</strong><br>`,l+=i(r,s&&s instanceof moment?s.tz(d):s));return l}(t.start_date,t.end_date,r.dagTZ||"UTC"),a}window.tiTooltip=d,window.taskNoInstanceTooltip=function(t,e){let a="";return t&&(a+=`Task_id: ${(0,n.escapeHtml)(t)}<br>`),void 0!==e.task_type&&(a+=`Operator: ${(0,n.escapeHtml)(e.task_type)}<br>`),a+="<br><em>DAG has yet to run.</em>",a}},8956:(t,e,a)=>{a.d(e,{Z2:()=>o,au:()=>n});function n(t){const e=document.querySelector(`meta[name="${t}"]`);return e?e.getAttribute("content"):null}const o=()=>new Map([["success",0],["failed",0],["upstream_failed",0],["up_for_retry",0],["up_for_reschedule",0],["running",0],["deferred",0],["sensing",0],["queued",0],["scheduled",0],["skipped",0],["no_status",0]])}},e={};function a(n){var o=e[n];if(void 0!==o)return o.exports;var r=e[n]={exports:{}};return t[n](r,r.exports,a),r.exports}a.d=(t,e)=>{for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),a.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};return(()=>{a.r(n);var t=a(8956),e=a(3897),o=a(1068);const r=(0,t.au)("dags_index"),s=(0,t.au)("paused_url"),i=(0,t.au)("status_filter"),d=(0,t.au)("autocomplete_url"),l=(0,t.au)("graph_url"),c=(0,t.au)("dag_run_url"),u=(0,t.au)("task_instance_url"),m=(0,t.au)("blocked_url"),p=(0,t.au)("csrf_token"),_=(0,t.au)("last_dag_runs_url"),f=(0,t.au)("dag_stats_url"),g=(0,t.au)("task_stats_url"),h=(0,t.au)("grid_url");$("#tags_filter").select2({placeholder:"Filter DAGs by tag",allowClear:!0}),$("#tags_filter").on("change",(t=>{t.preventDefault();const e=new URLSearchParams(window.location.search);t.val.length?(e.has("tags")&&e.delete("tags"),t.val.forEach((t=>{e.append("tags",t)}))):(e.delete("tags"),e.set("reset_tags","reset")),e.has("page")&&e.delete("page"),window.location=`${r}?${e.toString()}`})),$("#tags_form").on("reset",(t=>{t.preventDefault();const e=new URLSearchParams(window.location.search);e.delete("tags"),e.has("page")&&e.delete("page"),e.set("reset_tags","reset"),window.location=`${r}?${e.toString()}`})),$("#dag_query").on("keypress",(t=>{if(13===t.which){const e=new URLSearchParams(window.location.search);e.set("search",t.target.value.trim()),e.delete("page"),window.location=`${r}?${e.toString()}`,t.preventDefault()}})),$("#page_size").on("change",(function(){const t=$(this).val();window.location=`${r}?page_size=${t}`})),$.each($("[id^=toggle]"),(function(){const t=$(this),e=t.data("dag-id");t.on("change",(()=>{const a=t.is(":checked"),n=`${s}?is_paused=${a}&dag_id=${encodeURIComponent(e)}`;t.removeClass("switch-input--error"),t.trigger("blur"),$.post(n).fail((()=>{setTimeout((()=>{t.prop("checked",!a),t.addClass("switch-input--error")}),500)}))}))})),$(".typeahead").typeahead({source:(t,e)=>$.ajax(d,{data:{query:encodeURIComponent(t),status:i},success:e}),autoSelect:!1,afterSelect(t){const e=new URLSearchParams(window.location.search);e.set("search",t.name),"owner"===t.type&&(window.location=`${r}?${e}`),"dag"===t.type&&(window.location=`${h.replace("__DAG_ID__",t.name)}?${e}`)}}),$("#search_form").on("reset",(()=>{const t=new URLSearchParams(window.location.search);t.delete("search"),t.delete("page"),window.location=`${r}?${t}`})),$("#main_content").show(250);function v(t,e){$.each(e,(function(){const t=document.querySelector(`[data-dag-id="${this.dag_id}"]`);t.title=`${this.active_dag_run}/${this.max_active_runs} active dag runs`,this.active_dag_run>=this.max_active_runs&&(t.style.color="#e43921")}))}function b(t,e){$(".js-loading-last-run").remove(),Object.keys(e).forEach((t=>{const a=e[t].dag_id,n=e[t].execution_date,o=d3.select(`#last-run-${t}`);o.selectAll("a").attr("href",`${l}?dag_id=${encodeURIComponent(a)}&execution_date=${encodeURIComponent(n)}`).html("").insert(isoDateToTimeEl.bind(null,n,{title:!1})),o.selectAll("span").style("display",null).attr("data-lastrun",JSON.stringify(e[t]))}))}function w(t,e){const a=d3.select(`svg#dag-run-${t.replace(/\./g,"__dot__")}`).attr("height",37).attr("width","120px").selectAll("g").data(e).enter().append("g").attr("transform",((t,e)=>`translate(${29*e+16.5},18.5)`));a.append("svg:a").attr("href",(e=>`${c}?_flt_3_dag_id=${t}&_flt_3_state=${e.state}`)).append("circle").attr("id",(e=>`run-${t.replace(/\./g,"_")}${e.state||"none"}`)).attr("class","has-svg-tooltip").attr("stroke-width",(t=>t.count>0?2:1)).attr("stroke",(t=>t.count>0?STATE_COLOR[t.state]:"gainsboro")).attr("fill","#fff").attr("r",12.5).attr("title",(t=>t.state)).on("mouseover",(t=>{t.count>0&&d3.select(this).transition().duration(400).attr("fill","#e2e2e2").style("stroke-width",6)})).on("mouseout",(t=>{t.count>0&&d3.select(this).transition().duration(400).attr("fill","#fff").style("stroke-width",2)})).style("opacity",0).transition().duration(300).delay(((t,e)=>50*e)).style("opacity",1),d3.select(".js-loading-dag-stats").remove(),a.append("text").attr("fill","#51504f").attr("text-anchor","middle").attr("vertical-align","middle").attr("font-size",9).attr("y",3).style("pointer-events","none").text((t=>t.count>0?t.count:""))}function x(t,e){Object.keys(e).forEach((t=>{w(t,e[t])}))}function k(t,e){Object.keys(e).forEach((t=>{!function(t,e){const a=d3.select(`svg#task-run-${t.replace(/\./g,"__dot__")}`).attr("height",37).attr("width",29*e.length+4).selectAll("g").data(e).enter().append("g").attr("transform",((t,e)=>`translate(${29*e+16.5},18.5)`));a.append("svg:a").attr("href",(e=>`${u}?_flt_3_dag_id=${t}&_flt_3_state=${e.state}`)).append("circle").attr("id",(e=>`task-${t.replace(/\./g,"_")}${e.state||"none"}`)).attr("class","has-svg-tooltip").attr("stroke-width",(t=>t.count>0?2:1)).attr("stroke",(t=>t.count>0?STATE_COLOR[t.state]:"gainsboro")).attr("fill","#fff").attr("r",12.5).attr("title",(t=>t.state||"none")).on("mouseover",(function(t){t.count>0&&d3.select(this).transition().duration(400).attr("fill","#e2e2e2").style("stroke-width",6)})).on("mouseout",(function(t){t.count>0&&d3.select(this).transition().duration(400).attr("fill","#fff").style("stroke-width",2)})).style("opacity",0).transition().duration(300).delay(((t,e)=>50*e)).style("opacity",1),d3.select(".js-loading-task-stats").remove(),a.append("text").attr("fill","#51504f").attr("text-anchor","middle").attr("vertical-align","middle").attr("font-size",9).attr("y",3).style("pointer-events","none").text((t=>t.count>0?t.count:""))}(t,e[t])}))}function y({activeDagsOnly:t=!1}={}){let e=$("[id^=toggle]");return t&&(e=e.filter(":checked")),e=e.map((function(){return $(this).data("dag-id")})).get(),e}function T(t,e,a){d3.select(`svg#${t}-${e.replace(/\./g,"__dot__")}`).selectAll("circle").data(a).attr("stroke-width",(t=>t.count>0?2:1)).attr("stroke",(t=>t.count>0?STATE_COLOR[t.state]:"gainsboro")).attr("fill","#fff").attr("r",12.5).attr("title",(t=>t.state)).on("mouseover",(t=>{t.count>0&&d3.select(this).transition().duration(400).attr("fill","#e2e2e2").style("stroke-width",6)})),d3.select(`svg#${t}-${e.replace(/\./g,"__dot__")}`).selectAll("text").data(a).text((t=>t.count>0?t.count:""))}function S(t,e){Object.keys(e).forEach((t=>{T("task-run",t,e[t])}))}let A;function z(t,e){!function(t){0===Object.keys(t).filter((e=>t[e].filter((t=>"running"===t.state)).filter((t=>t.count>0)).length>0)).length&&($("#auto_refresh").prop("checked",!1),clearInterval(A))}(e),Object.keys(e).forEach((t=>{const a=e[t];w(t,a),T("dag-run",t,a)}))}function I({activeDagsOnly:t=!1}={}){const e=y({activeDagsOnly:t}),a=new URLSearchParams;e.forEach((t=>{a.append("dag_ids",t)})),$("#loading-dots").css("display","inline-block"),a.has("dag_ids")&&(d3.json(_).header("X-CSRFToken",p).post(a,b),d3.json(f).header("X-CSRFToken",p).post(a,z),d3.json(g).header("X-CSRFToken",p).post(a,S)),setTimeout((()=>{$("#loading-dots").css("display","none")}),2e3)}function C(){$("#auto_refresh").is(":checked")?A=setInterval((()=>{I({activeDagsOnly:!0})}),2e3*autoRefreshInterval):clearInterval(A)}function R(){const t=localStorage.getItem("dagsDisableAutoRefresh");$("#auto_refresh").prop("checked",!t),C(),d3.select("#refresh_button").on("click",(()=>I()))}d3.selectAll(".js-last-run-tooltip").on("mouseover",(function(){const t=JSON.parse(d3.select(this).attr("data-lastrun"));d3.select(this).attr("data-original-title",(0,e.default)(t))}));document.addEventListener("visibilitychange",(()=>{document.hidden?clearInterval(A):R()})),$(window).on("load",(()=>{R(),$("body").on("mouseover",".has-svg-tooltip",(t=>{const e=t.target;!function(t,e){const a=$("#svg-tooltip");a.children(".tooltip-inner").text(t);const n=a.width()/2;a.css({display:"block",left:e.left+12.5-n+"px",top:e.top-25+"px"})}(e.getAttribute("title"),e.getBoundingClientRect())})),$("body").on("mouseout",".has-svg-tooltip",(()=>{$("#svg-tooltip").css("display","none")})),function(){const t=y(),e=new URLSearchParams;t.forEach((t=>{e.append("dag_ids",t)})),e.has("dag_ids")?(d3.json(m).header("X-CSRFToken",p).post(e,v),d3.json(_).header("X-CSRFToken",p).post(e,b),d3.json(f).header("X-CSRFToken",p).post(e,x),d3.json(g).header("X-CSRFToken",p).post(e,k)):($(".js-loading-task-stats").remove(),$(".js-loading-dag-stats").remove())}()})),$(".js-next-run-tooltip").each(((t,e)=>{$(e).on("mouseover",(()=>{$(e).attr("data-original-title",(()=>{const t=$(e).attr("data-nextrun"),[a,n,r]=t.split(",");let s="";return s+=`<strong>Run After:</strong> ${(0,o.o0)(a)}<br>`,s+=`Next Run: ${(0,o.K5)(a)}<br><br>`,s+="<strong>Data Interval</strong><br>",s+=`Start: ${(0,o.o0)(n)}<br>`,s+=`End: ${(0,o.o0)(r)}`,s}))}))})),$("#auto_refresh").change((()=>{$("#auto_refresh").is(":checked")?(I({activeDagsOnly:!0}),localStorage.removeItem("dagsDisableAutoRefresh")):(localStorage.setItem("dagsDisableAutoRefresh","true"),$("#loading-dots").css("display","none")),C()}))})(),n})()));
