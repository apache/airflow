env {
  parallelism = 1
  job.mode = "BATCH"
}

source {
  FakeSource {
    plugin_output = "fake"
    parallelism = 1
    schema = {
      fields {
        name = "string"
        age = "int"
        email = "string"
      }
    }
    rows = [
      {
        kind = INSERT
        fields = ["John", 25, "john@example.com"]
      },
      {
        kind = INSERT
        fields = ["Jane", 30, "jane@example.com"]
      }
    ]
  }
}

transform {
  sql {
    plugin_input = "fake"
    plugin_output = "transformed"
    sql = "SELECT name, age, email FROM fake WHERE age > 20"
  }
}

sink {
  Console {
    plugin_input = "transformed"
  }
}